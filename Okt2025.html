<!DOCTYPE html>
<html lang="is">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Class+ Recipes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .accordion-content {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.3s ease-out;
            overflow: hidden;
        }
        .accordion-content.open {
            grid-template-rows: 1fr;
        }
        .inner-content {
            min-height: 0;
        }
        .recipe-card {
            transition: all 0.2s ease-in-out;
        }
        .recipe-card:hover {
            transform: translateY(-2px);
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
    </style>
</head>
<body class="min-h-screen pb-12">

    <!-- Sticky Header -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 px-4 py-4 mb-8 shadow-sm">
        <div class="max-w-4xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4">
            <div class="text-center sm:text-left">
                <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">
                    World Class+ Recipes
                </h1>
                <p id="subheading" class="text-slate-500 font-medium italic">√æ√≠n orka, √æinn √°rangur</p>
            </div>
            
            <button id="translate-button" onclick="toggleLanguage()" class="px-5 py-2.5 bg-indigo-600 text-white font-semibold rounded-xl shadow-sm hover:bg-indigo-700 active:scale-95 transition-all text-sm flex items-center gap-2">
                <span id="lang-flag">üá¨üáß</span>
                <span id="lang-text">Translate to English</span>
            </button>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4">
        <!-- Search and Filters -->
        <div class="mb-8 space-y-4">
            <div class="relative">
                <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-slate-400">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </span>
                <input type="text" id="search-input" oninput="handleSearch()" placeholder="Leita a√∞ uppskriftum e√∞a hr√°efnum..." class="w-full pl-10 pr-4 py-3 bg-white border border-slate-200 rounded-2xl shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
            </div>
            
            <div id="category-filters" class="flex flex-wrap gap-2 justify-center sm:justify-start">
                <!-- Filters injected by JS -->
            </div>
        </div>

        <div id="recipe-container" class="space-y-4">
            <!-- Recipes injected by JS -->
        </div>

        <!-- Empty State -->
        <div id="empty-state" class="hidden text-center py-20">
            <div class="text-6xl mb-4">üîç</div>
            <h3 class="text-xl font-bold text-slate-700">Engar uppskriftir fundust</h3>
            <p class="text-slate-500">Pr√≥fa√∞u a√∞ leita a√∞ √∂√∞ru or√∞i.</p>
        </div>
    </main>

    <footer class="text-center mt-16 text-slate-400 text-sm px-4">
        <p id="footer-tip">√Åbending: Smelltu √° flokk til a√∞ sj√° uppskriftirnar.</p>
        <p class="mt-2 opacity-75">&copy; 2025 World Class Nutrition</p>
    </footer>

    <script>
        const translations = {
            is: {
                subheading: "√æ√≠n orka, √æinn √°rangur",
                translateBtn: "Translate to English",
                flag: "üá¨üáß",
                searchPlaceholder: "Leita a√∞ uppskriftum e√∞a hr√°efnum...",
                footerTip: "√Åbending: Smelltu √° flokk til a√∞ sj√° uppskriftirnar.",
                ingredientsTitle: "Hr√°efni",
                instructionsTitle: "A√∞fer√∞ / √Ålegg",
                emptyTitle: "Engar uppskriftir fundust",
                emptySub: "Pr√≥fa√∞u a√∞ leita a√∞ √∂√∞ru or√∞i.",
                all: "Allt"
            },
            en: {
                subheading: "your energy, your results",
                translateBtn: "T√∫lka √° √çslensku",
                flag: "üáÆüá∏",
                searchPlaceholder: "Search recipes or ingredients...",
                footerTip: "Tip: Click on a category to expand recipes.",
                ingredientsTitle: "Ingredients",
                instructionsTitle: "Method / Topping",
                emptyTitle: "No recipes found",
                emptySub: "Try searching for something else.",
                all: "All"
            }
        };

        const recipes = [
            {
                category: { en: "Energy Drinks", is: "Energy Drykkir" },
                icon: "‚ö°",
                color: "bg-amber-50",
                borderColor: "border-amber-400",
                type: "drink",
                items: [
                    { name: { en: "Kraftur", is: "Kraftur" }, ingredients: { en: ["110g Vanilla Skyr", "100g Banana", "60g Strawberries", "30g Vanilla Protein"], is: ["110 g vanilluskyr", "100 g banana", "60 g jar√∞aber", "30 g vanillupr√≥tein"] }, instructions: { en: "Blend until smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } },
                    { name: { en: "Protein Iced Coffee", is: "Protein √çskaffi" }, ingredients: { en: ["200ml Double Espresso", "10ml Olive Oil", "30g Salted Caramel Protein"], is: ["200 ml tv√∂faldur espresso", "10 ml √≥l√≠fuol√≠a", "30 g salted caramel pr√≥tein"] }, instructions: { en: "Blend until smooth.", is: "Blanda√∞u √æar til drykkurinn ver√∞ur sl√©ttur." } },
                    { name: { en: "Snerpa", is: "Snerpa" }, ingredients: { en: ["60g Strawberries", "100g Banana", "90ml Apple Juice", "30g P/M Tango Protein"], is: ["60 g jar√∞aber", "100 g banana", "90 ml eplasafi", "30 g P/M Tango pr√≥tein"] }, instructions: { en: "Blend well until soft and smooth.", is: "Blanda√∞u vel √æar til √°fer√∞in er mj√∫k og sl√©tt." } }
                ]
            },
            {
                category: { en: "Strength Drinks", is: "Strength Drykkir" },
                icon: "üí™",
                color: "bg-rose-50",
                borderColor: "border-rose-400",
                type: "drink",
                items: [
                    { name: { en: "Massi", is: "Massi" }, ingredients: { en: ["140g Strawberries", "40g Dates", "60g Banana", "60g Peanut Butter", "8g Cocoa Powder", "200ml Almond Milk", "30g Cookie Protein"], is: ["140 g jar√∞aber", "40 g d√∂√∞lur", "60 g banana", "60 g hnetusmj√∂r", "8 g kak√≥duft", "200 ml m√∂ndlumj√≥lk", "30 g cookie pr√≥tein"] }, instructions: { en: "Blend until everything is silky smooth.", is: "Blanda√∞u √æar til allt er silkimj√∫kt." } },
                    { name: { en: "Orka", is: "Orka" }, ingredients: { en: ["60g Banana", "80g Oatmeal", "200ml Oat Milk", "60g Almond Butter", "30g Whey Protein"], is: ["60 g banana", "80 g haframj√∂l", "200 ml haframj√≥lk", "60 g m√∂ndlusmj√∂r", "30 g whey pr√≥tein"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } },
                    { name: { en: "Berjabomba", is: "Berjabomba" }, ingredients: { en: ["60g Raspberries", "60g Blueberries", "50ml Olive Oil", "200ml Coconut Milk", "30g Whey Protein"], is: ["60 g hindber", "60 g bl√°ber", "50 ml √≥l√≠fuol√≠a", "200 ml k√≥kosmj√≥lk", "30 g whey pr√≥tein"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } }
                ]
            },
            {
                category: { en: "Light Drinks", is: "Light Drykkir" },
                icon: "üçÉ",
                color: "bg-emerald-50",
                borderColor: "border-emerald-400",
                type: "drink",
                items: [
                    { name: { en: "Gr√¶n heilsa", is: "Gr√¶n heilsa" }, ingredients: { en: ["100g Spinach", "30g Mango", "155g Apple", "40g Celery", "20ml Ginger Juice", "30g Collagen Protein"], is: ["100 g sp√≠nat", "30 g mang√≥", "155 g epli", "40 g seller√≠", "20 ml engifersafi", "30 g collagen pr√≥tein"] }, instructions: { en: "Blend until soft and evenly mixed.", is: "Blanda√∞u √æar til √°fer√∞in er mj√∫k og j√∂fn." } },
                    { name: { en: "Brennsla", is: "Brennsla" }, ingredients: { en: ["155g Apple", "60g Mango", "60g Blueberries", "30ml Ginger", "30g Whey Protein"], is: ["155 g epli", "60 g mang√≥", "60 g bl√°ber", "30 ml engifer", "30 g whey pr√≥tein"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } },
                    { name: { en: "Upphitun", is: "Upphitun" }, ingredients: { en: ["110g Vanilla Skyr", "60g Strawberries", "60g Mango", "60g Pineapple"], is: ["110 g vanilluskyr", "60 g jar√∞aber", "60 g mang√≥", "60 g ananas"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } }
                ]
            },
            {
                category: { en: "Balance Drinks", is: "Balance Drykkir" },
                icon: "‚öñÔ∏è",
                color: "bg-sky-50",
                borderColor: "border-sky-400",
                type: "drink",
                items: [
                    { name: { en: "Gle√∞i", is: "Gle√∞i" }, ingredients: { en: ["20ml Lemon Juice", "30g Ginger", "60g Strawberries", "155g Apple", "30g Strawberry Protein"], is: ["20 ml s√≠tr√≥nusafi", "30 g engifer", "60 g jar√∞aber", "155 g epli", "30 g jar√∞aberja pr√≥tein"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } },
                    { name: { en: "L√≠f", is: "L√≠f" }, ingredients: { en: ["130g Avocado", "200g Apple", "140g Pineapple", "30g Ginger"], is: ["130 g av√≥kad√≥", "200 g epli", "140 g ananas", "30 g engifer"] }, instructions: { en: "Blend until the texture is soft and smooth.", is: "Blanda√∞u √æar til √°fer√∞in er mj√∫k og sl√©tt." } },
                    { name: { en: "Endurn√Ωjun", is: "Endurn√Ωjun" }, ingredients: { en: ["90ml Beetroot Juice", "130g Avocado", "30g Celery", "40g Strawberries", "155g Apple", "30ml Lemon Juice", "3g Spirulina"], is: ["90 ml rau√∞r√≥fusafi", "130 g av√≥kad√≥", "30 g seller√≠", "40 g jar√∞aber", "155 g epli", "30 ml s√≠tr√≥nusafi", "3 g spirulina"] }, instructions: { en: "Blend until the texture is smooth.", is: "Blanda√∞u √æar til √°fer√∞in er sl√©tt." } }
                ]
            },
            {
                category: { en: "Porridges", is: "Grautar" },
                icon: "üçö",
                color: "bg-orange-50",
                borderColor: "border-orange-400",
                type: "porridge",
                items: [
                    { 
                        name: { en: "Energy Porridge", is: "Energy Porridge" }, 
                        ingredients: { 
                            en: ["Base 270g: Almond Milk, Oats, Honey", "Cookies & Cream Protein 30g"], 
                            is: ["Grunnur 270 g: M√∂ndlumj√≥lk, Hafrar, Hunang", "Cookies & Cream pr√≥tein 30 g"] 
                        }, 
                        instructions: { 
                            en: "Stir the porridge and one scoop of protein together. Top with: 20g Almond Butter, 30g Blueberries, 30g Strawberries, half a banana.", 
                            is: "Hr√¶r√∞u grautinn og eina skei√∞ af pr√≥teini saman. B√¶ttu ofan √°: 20 g M√∂ndlusmj√∂r, 30 g Bl√°ber, 30 g Jar√∞aber, h√°lfur banani." 
                        } 
                    },
                    { 
                        name: { en: "Strength Porridge", is: "Strength Porridge" }, 
                        ingredients: { 
                            en: ["Base 270g: Almond Milk, Oats, Honey", "Vanilla Protein 30g"], 
                            is: ["Grunnur 270 g: M√∂ndlumj√≥lk, Hafrar, Hunang", "Vanillu Pr√≥tein 30 g"] 
                        }, 
                        instructions: { 
                            en: "Stir the porridge and one scoop of protein together. Top with: 20g Peanut Butter, 60g Banana, 20g Dates, 30g Blueberries.", 
                            is: "Hr√¶r√∞u grautinn og eina skei√∞ af pr√≥teini saman. B√¶ttu ofan √°: 20 g Hnetusmj√∂r, 60 g Banani, 20 g D√∂√∞lur, 30g bl√°ber." 
                        } 
                    },
                    { 
                        name: { en: "Balance Porridge", is: "Balance Porridge" }, 
                        ingredients: { 
                            en: ["Base 270g: Almond Milk, Oats, Honey", "Collagen 30g"], 
                            is: ["Grunnur 270 g: M√∂ndlumj√≥lk, Hafrar, Hunang", "Collagen 30 g"] 
                        }, 
                        instructions: { 
                            en: "Stir the porridge and one scoop of collagen together. Top with: 10g Hemp Seeds, 30g Blueberries, 30g Dates, 30g Strawberries.", 
                            is: "Hr√¶r√∞u grautinn og eina skei√∞ af collageni saman. B√¶ttu ofan √°: 10 g Hampfr√¶, 30 g Bl√°ber, 30 g D√∂√∞lur, jar√∞aber 30 g." 
                        } 
                    },
                    { 
                        name: { en: "Light Porridge", is: "Light Porridge" }, 
                        ingredients: { 
                            en: ["Base 270g: Almond Milk, Oats, Honey"], 
                            is: ["Grunnur 270 g: M√∂ndlumj√≥lk, Hafrar, Hunang"] 
                        }, 
                        instructions: { 
                            en: "Top with: 10g Hemp Seeds, 30g Strawberries, 10g Coconut Flakes, 30g Blueberries.", 
                            is: "B√¶ttu ofan √°: 10 g Hampfr√¶, 30 g Jar√∞aber, 10 g K√≥kosfl√∂gur, 30 g bl√°ber." 
                        } 
                    }
                ]
            },
            {
                category: { en: "Salads", is: "Salat" },
                icon: "ü•ó",
                color: "bg-teal-50",
                borderColor: "border-teal-400",
                type: "salad",
                items: [
                    { 
                        name: { en: "Energy Salad", is: "Energy Salat" }, 
                        ingredients: { 
                            en: ["100g Pasta", "70g Cherry Tomatoes", "90g Spinach", "20g Dates", "50g Cashews", "70g Feta Cheese", "100ml Pesto"], 
                            is: ["100 g pasta", "70 g kirsuberjat√≥matar", "90 g sp√≠nat", "20 g d√∂√∞lur", "50 g kasj√∫hnetur", "70 g fetaostur", "100 ml pest√≥"] 
                        }, 
                        instructions: { 
                            en: "Mix together and put in a box with the correct lid.", 
                            is: "Blandi√∞ saman og setji√∞ √≠ box me√∞ r√©ttu loki." 
                        } 
                    },
                    { 
                        name: { en: "Strength Salad", is: "Strength Salat" }, 
                        ingredients: { 
                            en: ["100g Pasta", "50g Salad Mix", "120g Chicken", "20g Dates", "15g Parmesan", "50g Grapes", "100ml Worldclass+ dressing"], 
                            is: ["100 g pasta", "50 g salat mix", "120 g kj√∫klingur", "20 g d√∂√∞lur", "15 g parmesan", "50 g v√≠nber", "100 ml Worldclass+ dressing"] 
                        }, 
                        instructions: { 
                            en: "Mix together and put in a box with the correct lid.", 
                            is: "Blandi√∞ saman og setji√∞ √≠ box me√∞ r√©ttu loki." 
                        } 
                    },
                    { 
                        name: { en: "Balance Salad", is: "Balance Salat" }, 
                        ingredients: { 
                            en: ["100g Salad Mix", "60g Chickpeas", "80g Avocado", "40g Red Onion", "70g Cucumber", "70g Cherry Tomatoes", "80ml French dressing"], 
                            is: ["100 g salat mix", "60 g kj√∫klingabaunir", "80 g av√≥kad√≥", "40 g rau√∞laukur", "70 g g√∫rka", "70 g kirsuberjat√≥matar", "80 ml fr√∂nsk dressing"] 
                        }, 
                        instructions: { 
                            en: "Mix together and put in a box with the correct lid.", 
                            is: "Blandi√∞ saman og setji√∞ √≠ box me√∞ r√©ttu loki." 
                        } 
                    },
                    { 
                        name: { en: "Light Salad", is: "Light Salat" }, 
                        ingredients: { 
                            en: ["100g Salad Mix", "120g Tuna", "50g Egg", "40g Red Onion", "70g Cucumber", "100g Cottage Cheese dressing"], 
                            is: ["100 g salat mix", "120 g t√∫nfiskur", "50 g egg", "40 g rau√∞laukur", "70 g g√∫rka", "100 g kotas√¶lu dressing"] 
                        }, 
                        instructions: { 
                            en: "Mix together and put in a box with the correct lid.", 
                            is: "Blandi√∞ saman og setji√∞ √≠ box me√∞ r√©ttu loki." 
                        } 
                    }
                ]
            },
            {
                category: { en: "Crispbreads", is: "Krisp" },
                icon: "üçû",
                color: "bg-stone-50",
                borderColor: "border-stone-400",
                type: "crisp",
                items: [
                    { 
                        name: { en: "Kj√∫klinga Krisp", is: "Kj√∫klinga Krisp" }, 
                        ingredients: { 
                            en: ["4 Finn Crisp", "80g Chicken", "10g Sweet & Sour Pickle", "5g Parsley", "15g Red Onion", "40ml Worldclass+ dressing"], 
                            is: ["4 stk Finn Crisp", "80 g Kj√∫klingur", "10 g S√∫r-s√¶t S√∫rsa√∞ G√∫rka", "5 g Steinselja", "15 g Rau√∞laukur", "40 ml Worldclass+ dressing"] 
                        }, 
                        instructions: { 
                            en: "Put 170g salad + 4 Finn Crisp + 40g tomatoes together in a box.", 
                            is: "Settu salat 170 g + 4 stk finkrisp + 40 g af t√≥m√∂tum saman √≠ box." 
                        } 
                    },
                    { 
                        name: { en: "T√∫nfisk & Egg Krisp", is: "T√∫nfisk & Egg Krisp" }, 
                        ingredients: { 
                            en: ["4 Finn Crisp", "45g Tuna", "10g Onion", "15g Cucumber", "5g Spring Onion", "20g Cottage Cheese", "15g Tomatoes", "20g Egg"], 
                            is: ["4 stk Finn Crisp", "45 g T√∫nfiskur", "10 g Laukur", "15 g G√∫rka", "5 g Vorlaukur", "20 g Kotas√¶la", "15 g T√≥matar", "20 g Egg"] 
                        }, 
                        instructions: { 
                            en: "Put 170g salad + 4 Finn Crisp + 50g egg together in a box.", 
                            is: "Settu salat 170 g + 4 stk finkrisp + 50 g af eggi saman √≠ box." 
                        } 
                    },
                    { 
                        name: { en: "Kj√∫klinga & Av√≥kad√≥ Krisp", is: "Kj√∫klinga & Av√≥kad√≥ Krisp" }, 
                        ingredients: { 
                            en: ["4 Finn Crisp", "80g Chicken", "10g Sweet & Sour Pickle", "5g Parsley", "15g Red Onion", "60g Avocado"], 
                            is: ["4 stk Finn Crisp", "80 g Kj√∫klingur", "10 g S√∫r-s√¶t S√∫rsa√∞ G√∫rka", "5 g Steinselja", "15 g Rau√∞laukur", "60 g Av√≥kad√≥"] 
                        }, 
                        instructions: { 
                            en: "Put 170g salad + 4 Finn Crisp + 60g avocado together in a box.", 
                            is: "Settu salat 170 g + 4 stk finkrisp + 60 g af avacado saman √≠ box." 
                        } 
                    },
                    { 
                        name: { en: "Hummus Krisp", is: "Hummus Krisp" }, 
                        ingredients: { 
                            en: ["4 Finn Crisp", "170g Hummus", "40g Tomatoes"], 
                            is: ["4 stk Finn Crisp", "170 g hummus", "40 g t√≥matar"] 
                        }, 
                        instructions: { 
                            en: "Put 170g hummus + 4 Finn Crisp + 40g tomatoes together in a box.", 
                            is: "Settu humus 170 g + 4 stk finkrisp + 40 g af t√≥m√∂tum saman √≠ box." 
                        } 
                    }
                ]
            }
        ];

        let currentLanguage = 'is';
        let searchQuery = '';
        let selectedCategory = null;

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'is' : 'en';
            updateStaticText();
            renderFilters();
            renderRecipes();
        }

        function updateStaticText() {
            const lang = translations[currentLanguage];
            document.getElementById('subheading').textContent = lang.subheading;
            document.getElementById('lang-text').textContent = lang.translateBtn;
            document.getElementById('lang-flag').textContent = lang.flag;
            document.getElementById('search-input').placeholder = lang.searchPlaceholder;
            document.getElementById('footer-tip').textContent = lang.footerTip;
            document.getElementById('empty-state').querySelector('h3').textContent = lang.emptyTitle;
            document.getElementById('empty-state').querySelector('p').textContent = lang.emptySub;
        }

        function handleSearch() {
            searchQuery = document.getElementById('search-input').value.toLowerCase();
            renderRecipes();
        }

        function setCategory(categoryName) {
            selectedCategory = selectedCategory === categoryName ? null : categoryName;
            renderFilters();
            renderRecipes();
        }

        function renderFilters() {
            const lang = currentLanguage;
            const filtersContainer = document.getElementById('category-filters');
            filtersContainer.innerHTML = '';
            
            const allBtn = document.createElement('button');
            allBtn.className = `px-4 py-1.5 rounded-full text-sm font-medium transition-all ${!selectedCategory ? 'bg-indigo-600 text-white shadow-md' : 'bg-white text-slate-600 border border-slate-200 hover:border-slate-300'}`;
            allBtn.textContent = translations[lang].all;
            allBtn.onclick = () => setCategory(null);
            filtersContainer.appendChild(allBtn);

            recipes.forEach(section => {
                const btn = document.createElement('button');
                const isSelected = selectedCategory === section.category[lang];
                btn.className = `px-4 py-1.5 rounded-full text-sm font-medium transition-all ${isSelected ? 'bg-indigo-600 text-white shadow-md' : 'bg-white text-slate-600 border border-slate-200 hover:border-slate-300'}`;
                btn.textContent = `${section.icon} ${section.category[lang]}`;
                btn.onclick = () => setCategory(section.category[lang]);
                filtersContainer.appendChild(btn);
            });
        }

        function renderRecipes() {
            const container = document.getElementById('recipe-container');
            container.innerHTML = '';
            const lang = currentLanguage;
            let visibleSections = 0;

            recipes.forEach((section, index) => {
                const isSelectedCategory = selectedCategory && section.category[lang] === selectedCategory;
                
                // Filtering
                if (selectedCategory && !isSelectedCategory) return;

                const filteredItems = section.items.filter(item => {
                    const nameMatch = item.name[lang].toLowerCase().includes(searchQuery);
                    const ingredientMatch = item.ingredients[lang].some(ing => ing.toLowerCase().includes(searchQuery));
                    return nameMatch || ingredientMatch;
                });

                if (searchQuery && filteredItems.length === 0) return;

                visibleSections++;
                const sectionId = `section-${index}`;
                
                // Determine if this section should be expanded by default
                const shouldBeExpanded = searchQuery !== '' || isSelectedCategory;

                const card = document.createElement('div');
                card.className = `recipe-card border border-slate-200 shadow-sm rounded-2xl overflow-hidden bg-white mb-4`;

                const title = document.createElement('div');
                title.className = 'flex justify-between items-center p-5 cursor-pointer hover:bg-slate-50 transition-colors';
                title.innerHTML = `
                    <div class="flex items-center gap-4">
                        <span class="w-10 h-10 rounded-xl ${section.color} border ${section.borderColor} flex items-center justify-center text-xl shadow-sm">
                            ${section.icon}
                        </span>
                        <h2 class="text-lg font-bold text-slate-800">${section.category[lang]}</h2>
                        <span class="bg-slate-100 text-slate-500 px-2 py-0.5 rounded-md text-xs font-bold uppercase tracking-wider">
                            ${filteredItems.length}
                        </span>
                    </div>
                    <svg id="arrow-${sectionId}" class="w-5 h-5 text-slate-400 transform transition-transform duration-300 ${shouldBeExpanded ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                `;
                title.onclick = () => toggleAccordion(sectionId);
                card.appendChild(title);

                const content = document.createElement('div');
                content.id = sectionId;
                content.className = `accordion-content ${shouldBeExpanded ? 'open' : ''}`;

                let recipesHtml = '';
                filteredItems.forEach(item => {
                    const ingredientsList = item.ingredients[lang].map(ing => `
                        <li class="flex items-start gap-2 py-1">
                            <span class="text-indigo-500 mt-1">‚Ä¢</span>
                            <span class="text-slate-600 font-medium">${ing}</span>
                        </li>`).join('');
                    
                    recipesHtml += `
                        <div class="p-5 border-t border-slate-100">
                            <h3 class="text-md font-bold text-indigo-700 mb-3">${item.name[lang]}</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <p class="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-2">${translations[lang].ingredientsTitle}</p>
                                    <ul class="text-sm">${ingredientsList}</ul>
                                </div>
                                <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
                                    <p class="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-2">${translations[lang].instructionsTitle}</p>
                                    <p class="text-sm text-slate-700 leading-relaxed font-medium">${item.instructions[lang]}</p>
                                </div>
                            </div>
                        </div>
                    `;
                });

                content.innerHTML = `<div class="inner-content">${recipesHtml}</div>`;
                card.appendChild(content);
                container.appendChild(card);
            });

            document.getElementById('empty-state').classList.toggle('hidden', visibleSections > 0);
        }

        function toggleAccordion(id) {
            const content = document.getElementById(id);
            const arrow = document.getElementById(`arrow-${id}`);
            content.classList.toggle('open');
            arrow.classList.toggle('rotate-180');
        }

        window.onload = () => {
            renderFilters();
            renderRecipes();
        };
    </script>
</body>
</html>
